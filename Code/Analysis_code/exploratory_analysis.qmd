---
title: "Exploratory Analysis - Korey Wetherell"
author: "Korey Wetherell"
date: "2025-04-17"
format: html
execute:
  echo: true
---

This Quarto file documents my workflow for conducting an exploratory analysis of the Palmer Penguins dataset as part of our course assignment, and this first part pulls from the original instructions provided in ZOOL710. While the structure of this document follows the class guidelines, I’ve adjusted the language to reflect the steps I took and the rationale behind each part of the process.

I’ve chosen to keep the procedural guidance visible so that others reviewing this file — either for replication or instructional purposes — can understand how each stage connects to the overall project. This includes loading the cleaned data, generating summary statistics, and producing visualizations to better understand variable distributions and potential relationships.

In short, this is not just a script — it’s a narrated walkthrough of how I approached and implemented an exploratory data analysis workflow using tools we’ve discussed in class, with the intention of grounding my final analysis in both clear documentation and replicability.

# Setup

This needs to run to load the R script so we can include the code chunks below.

```{r }
#| cache = FALSE
knitr::read_chunk('statistical_analysis.R')
```

Load needed packages and filepaths.  

```{r setup}
#| message: FALSE
#| warning: FALSE
```

Load custom functions.

```{r functions}
```

Load the data.

```{r loaddata}
```

# Create a summary table

In any paper you should always report a summary of the data. This includes basic statsistics for your data including sample size, counts, and means and standard errors for continuous data. 

Here we will use skimr which produces a summary table, but with more than we want. Letʻs save it as an object so we can grab the elements we want. 

It turns out that the `skim()` function returns a tibble. We can coerce it to a dataframe and use `head()` to see what the column names are and what the data look like. 

```{r, summarize}
```

## Select columns for a final summary table

Letʻs retain only the variable, N, mean, sd, and category counts, but letʻs rename them. Since we will use the SD to compute the stadard error letʻs just rename it as SE now and save a step later.  (Remember the standard error is just the standard deviation/ square root(sample size)). 

Note: The `results="asis"` is an option for `knitr` to layout the the results without the code formatting. Normally output from code chunks has the look of R output. `"asis"` (as in "as is", lol) removes that behavior, so we can lay it out as a typeset table for print. 

```{r summary.table, results="asis"}
```


# Do species differ in size?

As an example, letʻs ask the question _Do species differ in size?_ Our first try is a boxplot of mass by species:

```{r mass_species_boxplot}
```

The results were created by the `statistical_analysis.R` script and to the `Results` folder. Depending on how many tables/figures and workflow steps you have, it might make sense to have subfoldersf. Just choose a setup that makes sense for your project and works for you, and provide enough documentation that someone can understand what you are doing.

Now letʻs try a density plot

```{r mass_species_demsotu}
```

Provide a brief diescription of your results. To test the statistical significance of this result we can use ANOVA. We see that species do differ in size and this is a very robust statistical result. 

```{r mass_species_aov}
```

# Does the island have an affect on size?

What about an island effect? Since we know that species differ, we can include a two-way ANOVA and test both factors. 


When we add island to the model _after_ we account for species, it is not significant. 

```{r mass_species_island_aov}
```

However, if we add island _first, before_ species, it is signficant! We interpret this as islands differing in mass as well, but islands are not as different as species are in mass. 

```{r mass_island_species_aov}
```
Letʻs plot both factors together to see whatʻs going on. 

```{r mass_species_island_density}
```

# Notes

For your own explorations, tables and figures can be "quick and dirty". As long as you can see what's going on, there is no need to polish them. That's in contrast to figures you'll produce for your final products (paper, report, presentation, website, etc.). Those should look as nice, polished and easy to understand as possible.

### First Question from Korey

## Does Island Location Influence Penguin Size?

**Hypothesis:** Penguins on different islands will have different body masses due to environmental factors such as food availability, temperature, and nesting conditions.

**Analysis Approach:**  
To test this hypothesis, I used an **Analysis of Variance (ANOVA)**, which is appropriate when comparing the means of a continuous variable (body mass) across more than two groups (islands). ANOVA helps determine whether differences in group means are statistically significant, without increasing Type I error as multiple t-tests would.

---

```{r setup, echo=TRUE}
# Load necessary libraries
library(ggplot2)
library(dplyr)
library(car)  # For Levene's Test
```

```{r clean-column-names, echo=TRUE}
# Replace spaces in column names with underscores for easier referencing
colnames(dat) <- gsub(" ", "_", colnames(dat))
```

```{r summary-stats, echo=TRUE}
# Generate summary statistics by island
dat %>%
  group_by(Island) %>%
  summarize(mean_mass = mean(`Body_Mass_(g)`, na.rm = TRUE),
            sd_mass = sd(`Body_Mass_(g)`, na.rm = TRUE),
            count = n())
```

```{r plot_body_mass_island, echo=TRUE, fig.width=7, fig.height=5}
# Boxplot to visualize body mass distribution by island
ggplot(dat, aes(x = Island, y = `Body_Mass_(g)`, fill = Island)) + 
  geom_boxplot() + 
  theme_minimal() + 
  labs(title = "Comparison of Body Mass by Island", 
       x = "Island", 
       y = "Body Mass (g)")
```

---

### Statistical Test: ANOVA

```{r run-anova, echo=TRUE}
# Run ANOVA to test if body mass differs by island
anova_model <- aov(`Body_Mass_(g)` ~ Island, data = dat)
summary(anova_model)
```

---

### Assumption Checks

```{r check-normality, echo=TRUE}
# Normality check: residual plot
plot(anova_model, which = 2)
```

```{r levene-test, echo=TRUE}
# Test for homogeneity of variances (Levene's Test)
leveneTest(`Body_Mass_(g)` ~ Island, data = dat)
```

---

### Interpretation:
Based on the results of the ANOVA and assumption checks, I can begin to determine whether island location has a statistically significant effect on penguin body mass. The residual plot helps evaluate whether the model assumptions of normality are reasonable, and Levene's Test checks whether variance across groups is similar. If both assumptions are reasonably met, the ANOVA results can be considered valid.



